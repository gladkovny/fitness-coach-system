-- Диагностика и связывание тренера с Auth (выполнить в SQL Editor по шагам)

-- ═══════════════════════════════════════════════════════════════
-- ШАГ 1: Что в trainers?
-- ═══════════════════════════════════════════════════════════════
SELECT id, email, name, auth_id FROM trainers;

-- ═══════════════════════════════════════════════════════════════
-- ШАГ 2: Есть ли пользователь в auth.users?
-- ═══════════════════════════════════════════════════════════════
SELECT id, email, created_at FROM auth.users WHERE email = 'gladkovny@gmail.com';

-- ═══════════════════════════════════════════════════════════════
-- ШАГ 3: Связать ВСЕХ тренеров с пользователем gladkovny@gmail.com
-- (если тренер один — обновится он; если несколько — укажи нужный id вручную)
-- ═══════════════════════════════════════════════════════════════
UPDATE trainers
SET auth_id = (SELECT id FROM auth.users WHERE email = 'gladkovny@gmail.com' LIMIT 1)
WHERE id = (SELECT id FROM trainers ORDER BY created_at LIMIT 1);

-- Если нужно привязать к конкретному тренеру по id — замени последнюю строку на:
-- WHERE id = 'UUID_ТРЕНЕРА_ИЗ_ШАГА_1';

-- ═══════════════════════════════════════════════════════════════
-- ШАГ 4: Проверка
-- ═══════════════════════════════════════════════════════════════
SELECT t.id, t.email, t.name, t.auth_id, u.email AS auth_email
FROM trainers t
LEFT JOIN auth.users u ON t.auth_id = u.id;
