# ПРОМПТ ДЛЯ CLAUDE: Архитектура Fitness Coach System

> **Цель:** Проработать архитектуру полноценного SaaS-сервиса для фитнес-тренеров и их клиентов

---

## ТЕКУЩЕЕ СОСТОЯНИЕ ПРОЕКТА

### Что уже есть:

**Backend:**
- Google Apps Script (GAS) как API
- Google Sheets как база данных
- Два API: Master API (офлайн клиенты) + online_API_v4 (онлайн клиенты)

**Frontend:**
- Дашборд офлайн клиентов (`src/dashboard/`)
- Дашборд онлайн клиентов (`src/online/dashboard/`)
- Трекер тренера (`src/tracker/`)
- Assessment форма (`src/tracker/assessment.html`)
- Программа тренировок (`src/online/program/`)

**Модули:**
- Общие стили (`src/css/common.css`)
- API модуль (`src/js/api.js`)
- Утилиты (`src/js/utils.js`)

**Клиенты:**
- **Mark** (online) — 90-дневная программа, свой API
- **Yaroslav** (offline) — сплит, общий дашборд
- **Kirill** (offline) — фулбоди, общий дашборд
- **Alena** (hybrid) — тест онбординга

---

## ЦЕЛЬ СИСТЕМЫ

### Для тренеров:
1. **Быстрое формирование программ** — создание тренировочных планов
2. **Удобное заполнение** — трекер тренировок клиентов
3. **Аналитика** — анализ прогресса, статистика

### Для клиентов:
1. **Удобный дашборд** — визуализация прогресса
2. **Ключевые моменты** — важные метрики и достижения
3. **Взаимодействие** — связь с тренером

---

## БУДУЩИЕ ИНТЕГРАЦИИ

- **Whoop** — синхронизация данных о сне, восстановлении, нагрузке
- **Другие wellness трекеры** — Apple Health, Garmin, Fitbit
- **Сервисы питания** — MyFitnessPal, FatSecret
- **Календари** — Google Calendar, Apple Calendar

---

## КОНЦЕПЦИЯ СИСТЕМЫ

### Центральная идея:
**Единый центр данных о клиенте фитнес-тренера** со встроенной CRM-системой для:
- Работы с текущими клиентами
- Интеграции новых клиентов (онбординг)
- Автоматизации рутинных задач

### Роль ИИ:
- **Помощник при заполнении** — автодополнение, подсказки
- **Обработка данных** — парсинг, нормализация
- **Геймификация** — достижения, мотивация
- **Анализ данных** — инсайты, рекомендации

---

## ЗАДАЧИ ДЛЯ CLAUDE

### 1. АРХИТЕКТУРА ДАННЫХ
- Как организовать хранение данных (Google Sheets → будущая миграция?)
- Структура базы для тренеров и клиентов
- Синхронизация между источниками (Whoop, трекеры)
- Версионирование программ и данных

**Вопросы для обсуждения:**
- Нужна ли миграция с Google Sheets на полноценную БД?
- Как организовать multi-tenancy (несколько тренеров)?
- Какая структура данных оптимальна для аналитики?

### 2. АРХИТЕКТУРА API
- RESTful vs GraphQL
- Аутентификация и авторизация
- Rate limiting, кэширование
- Webhooks для интеграций

**Вопросы для обсуждения:**
- Остаёмся на GAS или мигрируем на Node.js/Python?
- Как организовать API для разных типов клиентов?
- Нужен ли единый API Gateway?

### 3. ФРОНТЕНД АРХИТЕКТУРА
- Монолит vs Микросервисы (SPA)
- Компонентная структура
- State management
- Offline-first подход

**Вопросы для обсуждения:**
- React/Vue/Angular или остаёмся на Vanilla JS?
- Нужен ли единый фронтенд или отдельные приложения?
- PWA для мобильных устройств?

### 4. ИНТЕГРАЦИИ
- Архитектура интеграций (Whoop, трекеры)
- OAuth для сторонних сервисов
- Синхронизация данных (pull/push)
- Обработка ошибок и retry логика

**Вопросы для обсуждения:**
- Какие интеграции приоритетны?
- Как обрабатывать конфликты данных?
- Нужен ли единый интеграционный слой?

### 5. ИИ КОМПОНЕНТЫ
- Где использовать ИИ (заполнение, анализ, рекомендации)
- Модели и провайдеры (OpenAI, Anthropic, локальные)
- Промпты и контекст
- Кэширование ответов ИИ

**Вопросы для обсуждения:**
- Какие задачи автоматизировать ИИ?
- Как интегрировать ИИ в существующий workflow?
- Нужен ли отдельный AI Gateway?

### 6. CRM ФУНКЦИОНАЛ
- Управление клиентами
- Онбординг процесс
- Коммуникации (уведомления, напоминания)
- Биллинг и подписки

**Вопросы для обсуждения:**
- Какие CRM функции критичны?
- Как организовать workflow тренера?
- Нужна ли система уведомлений?

### 7. АНАЛИТИКА И ОТЧЁТЫ
- Дашборды для тренера
- Дашборды для клиента
- Экспорт данных
- Прогнозирование

**Вопросы для обсуждения:**
- Какие метрики важны для тренера?
- Какие метрики мотивируют клиента?
- Нужна ли система отчётов?

### 8. БЕЗОПАСНОСТЬ И ПРИВАТНОСТЬ
- Аутентификация (OAuth, JWT)
- Шифрование данных
- GDPR compliance
- Доступ к данным клиента

**Вопросы для обсуждения:**
- Как организовать доступ к данным?
- Нужна ли двухфакторная аутентификация?
- Как обрабатывать персональные данные?

### 9. МАСШТАБИРУЕМОСТЬ
- Горизонтальное масштабирование
- Оптимизация запросов
- Кэширование
- CDN для статики

**Вопросы для обсуждения:**
- Сколько клиентов планируется?
- Какие пиковые нагрузки ожидаются?
- Нужна ли геораспределённость?

### 10. UX/UI ДИЗАЙН
- Единый дизайн-система
- Адаптивность (mobile-first)
- Accessibility
- Онбординг UX

**Вопросы для обсуждения:**
- Нужна ли единая дизайн-система?
- Какие платформы приоритетны (web/mobile)?
- Как упростить onboarding?

---

## ФОРМАТ РАБОТЫ

### Этап 1: Вопросы
Claude задаёт вопросы по каждому разделу выше, чтобы понять:
- Приоритеты
- Ограничения
- Предпочтения
- Бюджет и ресурсы

### Этап 2: Предложения
На основе ответов Claude предлагает:
- Архитектурные решения
- Технологический стек
- План миграции
- Roadmap развития

### Этап 3: Детализация
Проработка конкретных компонентов:
- Схемы БД
- API endpoints
- Компоненты UI
- Интеграции

---

## КОНТЕКСТ ПРОЕКТА

**Владелец:** Николай (фитнес-тренер, Бали)

**Текущий стек:**
- Backend: Google Apps Script
- Database: Google Sheets
- Frontend: Vanilla HTML/CSS/JS
- Hosting: Netlify
- Charts: Chart.js

**Ограничения:**
- Минимум зависимостей
- Простота развёртывания
- Низкая стоимость инфраструктуры

**Приоритеты:**
- Удобство использования
- Быстрая разработка
- Масштабируемость (в будущем)

---

## НАЧНИ С ЭТОГО

Claude, начни с раздела **"1. АРХИТЕКТУРА ДАННЫХ"** и задай 5-7 ключевых вопросов, чтобы понять:
- Текущие боли с Google Sheets
- Планы по масштабированию
- Необходимость миграции
- Структуру данных для разных типов клиентов

После ответов переходи к следующему разделу.

---

## ПРАВИЛА ПРИ ИЗМЕНЕНИЯХ И СИНХРОНИЗАЦИЯ

При любых изменениях в проекте (структура, код, документация) руководствуйся **docs/CLAUDE_RULES.md**:

1. **Автоматически** обновляй README, .cursorrules, docs/API.md — если меняется структура или API.
2. **После каждого ответа с изменениями** добавляй в конец блок «Синхронизация»:
   - Напомни выполнить `.\scripts\sync-claude.ps1` для обновления CLAUDE.md.
   - Напомни при необходимости обновить `deploy/master/` или `deploy/mark/` и залить на Netlify.

Полный текст правил и шаблон напоминания — в `docs/CLAUDE_RULES.md`. Добавь этот файл в проект и следуй ему при каждой правке.

---

## ДЛЯ CLAUDE: РЕЖИМ ПРОЕКТА

Если пользователь работает в **Claude Projects** (claude.ai), контекст сохраняется между чатами. Рекомендуй подгрузить в проект один раз:

| Файл | Назначение |
|------|------------|
| `CLAUDE.md` | Структура проекта, стек, клиенты |
| `docs/ARCHITECTURE_PROMPT.md` | Этот промпт и разделы для проработки |
| `docs/CLAUDE_RULES.md` | Правила изменений и синхронизации |
| `docs/ARCHITECTURE_V2.md` | Целевая архитектура и roadmap |
| `docs/API.md` | Текущие API (по желанию) |

Подробная инструкция: **docs/ARCHITECTURE_USAGE.md**. После подгрузки этих файлов можно начинать с раздела «НАЧНИ С ЭТОГО» в любом чате проекта без повторной вставки промпта.
