# FITNESS COACH SYSTEM — Архитектура v2.0

> **Дата:** 29 января 2026
> **Статус:** Утверждённая архитектура
> **Владелец:** Николай (Бали)

---

## 🎯 ВИДЕНИЕ ПРОДУКТА

### Миссия
Единый центр данных о клиенте фитнес-тренера со встроенной CRM-системой, интеграциями с wellness-трекерами и AI-помощником для обработки данных.

### Ключевые принципы
1. **Клиент не заполняет то, что можно получить автоматически**
2. **AI = обработка данных. Тренер = принятие решений**
3. **Простота использования важнее функциональности**
4. **Mobile-first, но удобно и на десктопе**

### Целевая аудитория

| Роль | Потребности |
|------|-------------|
| **Тренер** | Быстрое создание программ, трекинг тренировок, аналитика, CRM |
| **Клиент** | Понятный дашборд прогресса, минимум ручного ввода |
| **Админ** | Управление тренерами, биллинг, общая аналитика |

---

## 🏗️ ТЕХНИЧЕСКАЯ АРХИТЕКТУРА

### Целевой стек

| Компонент | Текущее | Целевое | Причина миграции |
|-----------|---------|---------|------------------|
| **Database** | Google Sheets | Supabase (PostgreSQL) | Скорость, масштабируемость, история |
| **Backend** | Google Apps Script | Supabase Edge Functions | Один URL навсегда, версионирование |
| **Frontend** | Vanilla HTML/JS | React + PWA | Компоненты, нет дублирования |
| **Hosting** | Netlify | Vercel / Netlify | PWA поддержка |
| **Auth** | Нет | Supabase Auth | Email + пароль |
| **AI** | Нет | OpenAI / Claude API | Питание, упражнения, аналитика |
| **Storage** | Google Drive | Supabase Storage | Фото еды, прогресса |

### Архитектурная схема

```
┌─────────────────────────────────────────────────────────────────────┐
│                        FITNESS COACH SYSTEM                         │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │
│  │   TRAINER    │  │    CLIENT    │  │    ADMIN     │              │
│  │     APP      │  │     APP      │  │    PANEL     │              │
│  │   (React)    │  │   (React)    │  │   (React)    │              │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘              │
│         │                 │                 │                       │
│         └─────────────────┼─────────────────┘                       │
│                           │                                         │
│                    ┌──────▼──────┐                                  │
│                    │  API LAYER  │                                  │
│                    │  (Supabase) │                                  │
│                    └──────┬──────┘                                  │
│                           │                                         │
│    ┌──────────────────────┼──────────────────────┐                 │
│    │                      │                      │                 │
│    ▼                      ▼                      ▼                 │
│ ┌──────────┐      ┌──────────────┐      ┌──────────────┐          │
│ │ DATABASE │      │  AI LAYER   │      │ INTEGRATIONS │          │
│ │ Supabase │      │ OpenAI/Claude│      │ Whoop/Apple  │          │
│ │ Postgres │      │             │      │ InBody OCR   │          │
│ └──────────┘      └──────────────┘      └──────────────┘          │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 📊 АРХИТЕКТУРА ДАННЫХ

### Структура базы данных

```sql
-- ПОЛЬЗОВАТЕЛИ И РОЛИ
trainers (
  id, email, password_hash, name, 
  subscription_plan, subscription_expires,
  created_at, settings
)

clients (
  id, trainer_id, email, password_hash, name,
  status, -- lead | onboarding | active | paused | churned
  profile, -- JSON: возраст, рост, цели, ограничения
  created_at, updated_at
)

-- ТРЕНИРОВКИ
exercises (
  id, trainer_id, -- NULL = общая база
  name, category, subcategory, 
  muscle_coefficients, -- JSON
  equipment, laterality, video_url
)

programs (
  id, trainer_id, client_id,
  name, type, -- online | offline | hybrid
  status, created_at
)

training_blocks (
  id, program_id, 
  name, total_sessions, used_sessions,
  start_date, status
)

workout_sessions (
  id, client_id, block_id,
  date, type, status, notes
)

workout_sets (
  id, session_id, exercise_id,
  set_number, reps, weight, rpe, rest_time
)

-- ЕЖЕДНЕВНЫЕ ДАННЫЕ
daily_logs (
  id, client_id, date,
  weight, sleep_hours, sleep_quality,
  recovery_score, strain, hrv,
  notes, source -- manual | whoop | oura | apple
)

nutrition_logs (
  id, client_id, date, meal_type,
  photo_url, ai_analysis, -- JSON от AI
  calories, protein, fats, carbs,
  confirmed -- подтверждено пользователем
)

body_composition (
  id, client_id, date,
  weight, body_fat, muscle_mass,
  water, bone_mass, bmr,
  source -- manual | inbody_ocr
)

-- ИНТЕГРАЦИИ
integrations (
  id, client_id, provider, -- whoop | oura | apple | google_fit
  access_token, refresh_token,
  last_sync, status
)

-- ФИНАНСЫ
payments (
  id, trainer_id, client_id,
  amount, currency, package_type,
  sessions_total, sessions_remaining,
  payment_date, status
)

-- ГЕЙМИФИКАЦИЯ
achievements (
  id, client_id, type,
  title, description, -- "Поднял вес 3 холодильников"
  value, earned_at
)

streaks (
  id, client_id, type, -- sleep | workouts | nutrition
  current_count, best_count, last_date
)
```

### Миграция данных

```
Google Sheets → Supabase

Coach_Master/Clients     → trainers + clients
Coach_Master/Exercises   → exercises
Client_Sheet/Daily       → daily_logs
Client_Sheet/WorkoutLog  → workout_sets
Client_Sheet/Blocks      → training_blocks
```

---

## 🔌 API АРХИТЕКТУРА

### Структура endpoints

```
/api/v1/

├── /auth/
│   ├── POST /login          — вход
│   ├── POST /register       — регистрация
│   └── POST /refresh        — обновление токена

├── /trainer/
│   ├── GET    /clients              — список клиентов
│   ├── POST   /clients              — создать клиента
│   ├── GET    /clients/:id          — профиль клиента
│   ├── PATCH  /clients/:id          — обновить клиента
│   ├── GET    /clients/:id/stats    — статистика клиента
│   │
│   ├── GET    /programs             — программы
│   ├── POST   /programs             — создать программу
│   ├── GET    /exercises            — база упражнений
│   ├── POST   /exercises            — добавить упражнение
│   │
│   ├── POST   /sessions/start       — начать тренировку
│   ├── POST   /sessions/:id/set     — добавить подход
│   ├── POST   /sessions/:id/finish  — завершить тренировку
│   │
│   └── GET    /analytics            — аналитика

├── /client/
│   ├── GET    /dashboard            — данные дашборда
│   ├── GET    /progress             — детальный прогресс
│   ├── POST   /daily                — ввод дневных данных
│   ├── GET    /achievements         — достижения
│   └── GET    /history              — история тренировок

├── /integrations/
│   ├── POST   /whoop/connect        — подключить Whoop
│   ├── POST   /whoop/sync           — синхронизация
│   ├── POST   /apple/sync           — Apple Health
│   ├── POST   /inbody/ocr           — распознать фото InBody
│   └── GET    /status               — статус интеграций

├── /ai/
│   ├── POST   /nutrition/analyze    — анализ фото еды
│   ├── POST   /exercise/recognize   — распознать упражнение
│   └── GET    /insights/:clientId   — инсайты по клиенту

└── /admin/
    ├── GET    /trainers             — все тренеры
    ├── GET    /billing              — платежи
    └── GET    /stats                — общая статистика
```

### Realtime подписки (для интеграций)

```javascript
// Клиент подписывается на обновления
supabase
  .channel('daily_logs')
  .on('postgres_changes', 
    { event: 'INSERT', schema: 'public', table: 'daily_logs' },
    (payload) => updateDashboard(payload.new)
  )
  .subscribe()
```

---

## 🎨 ФРОНТЕНД АРХИТЕКТУРА

### Структура приложения

```
app.fitness-olympus.com/

├── /                       — лендинг
├── /login                  — вход (тренер / клиент)
├── /register               — регистрация тренера

├── /trainer/               — панель тренера
│   ├── /dashboard          — главный экран
│   ├── /clients            — список клиентов
│   ├── /clients/:id        — карточка клиента
│   ├── /clients/:id/program — программа клиента
│   ├── /session            — трекер тренировки (mobile-first)
│   ├── /exercises          — база упражнений
│   ├── /analytics          — аналитика
│   ├── /payments           — финансы
│   └── /settings           — настройки

├── /client/:id/            — дашборд клиента
│   ├── /                   — главный экран (простой)
│   ├── /progress           — детальный прогресс
│   ├── /history            — история тренировок
│   ├── /achievements       — достижения
│   └── /nutrition          — чат с AI для питания

└── /admin/                 — админ-панель (для тебя)
    ├── /trainers           — управление тренерами
    ├── /billing            — подписки и платежи
    └── /stats              — общая статистика
```

### Дизайн-система "Olympus"

**Концепция:** Notion-минимализм + эстетика древнегреческих героев

**Цветовая палитра:**
```css
:root {
  /* Основные */
  --bg-primary: #FAFAFA;      /* Светлый мрамор */
  --bg-secondary: #F5F5F5;    /* Серый мрамор */
  --text-primary: #1A1A1A;    /* Почти чёрный */
  --text-secondary: #6B6B6B;  /* Серый */
  
  /* Акценты */
  --gold: #C9A227;            /* Олимпийское золото */
  --gold-light: #F4E4BA;      /* Светлое золото */
  --laurel: #4A7C59;          /* Лавровый зелёный */
  
  /* Статусы */
  --success: #4A7C59;         /* Победа */
  --warning: #C9A227;         /* Внимание */
  --error: #8B3A3A;           /* Ошибка (тёмно-красный) */
  --info: #4A6FA5;            /* Информация */
}
```

**Типографика:**
```css
/* Заголовки — классика */
font-family: 'Playfair Display', Georgia, serif;

/* Текст — современность */
font-family: 'Inter', -apple-system, sans-serif;
```

**Элементы геймификации:**
- 🏛️ Иконки в греческом стиле
- 🏆 Золотые бейджи достижений
- 🌿 Лавровые венки для серий
- ⚡ Молнии для рекордов

### Компонентная структура (React)

```
src/
├── components/
│   ├── ui/                 — базовые компоненты
│   │   ├── Button.jsx
│   │   ├── Card.jsx
│   │   ├── Input.jsx
│   │   ├── Modal.jsx
│   │   └── Badge.jsx
│   │
│   ├── trainer/            — компоненты тренера
│   │   ├── ClientCard.jsx
│   │   ├── SessionTracker.jsx
│   │   ├── ExerciseSelector.jsx
│   │   └── ProgramBuilder.jsx
│   │
│   ├── client/             — компоненты клиента
│   │   ├── ProgressChart.jsx
│   │   ├── AchievementBadge.jsx
│   │   ├── DailyStats.jsx
│   │   └── NutritionChat.jsx
│   │
│   └── shared/             — общие компоненты
│       ├── Header.jsx
│       ├── Navigation.jsx
│       └── LoadingSpinner.jsx
│
├── pages/                  — страницы
├── hooks/                  — кастомные хуки
├── services/               — API вызовы
├── stores/                 — состояние (Zustand)
└── utils/                  — утилиты
```

---

## 🤖 AI-КОМПОНЕНТЫ

### Модули AI

```
┌─────────────────────────────────────────────────────────────────┐
│                         AI LAYER                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  NUTRITION AI                                            │   │
│  │  ├── Вход: фото еды + контекст клиента                  │   │
│  │  ├── Обработка: GPT-4 Vision / Claude                   │   │
│  │  ├── Выход: продукты, КБЖУ, уверенность                 │   │
│  │  └── Действие: подтверждение → сохранение               │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  EXERCISE AI                                             │   │
│  │  ├── Вход: название упражнения (текст/голос)            │   │
│  │  ├── Обработка: fuzzy match + explicit rules            │   │
│  │  ├── Выход: exercise_id, muscle_coefficients            │   │
│  │  └── Действие: автозаполнение в трекере                 │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  ANALYTICS AI                                            │   │
│  │  ├── Вход: история клиента (тренировки, сон, питание)   │   │
│  │  ├── Обработка: поиск паттернов и корреляций            │   │
│  │  ├── Выход: инсайты для тренера                         │   │
│  │  │   • "Недосып коррелирует с падением силы"            │   │
│  │  │   • "Стагнация в жиме 3 недели"                      │   │
│  │  │   • "Дефицит белка в питании"                        │   │
│  │  └── Действие: уведомление тренеру                      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  GAMIFICATION ENGINE                                     │   │
│  │  ├── Рекорды: новый максимум в упражнении              │   │
│  │  ├── Серии: 7 дней подряд норма сна                     │   │
│  │  ├── Необычные факты:                                   │   │
│  │  │   • "Выработал энергии как чайник"                   │   │
│  │  │   • "Поднял вес равный 3 холодильникам"              │   │
│  │  │   • "Съел белка как 10 куриных грудок"               │   │
│  │  └── Групповые сравнения (с согласия)                   │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Пример: анализ питания

```javascript
// Запрос к AI
const analyzeNutrition = async (photoUrl, clientContext) => {
  const prompt = `
    Проанализируй фото еды и определи:
    1. Список продуктов с граммовкой
    2. Калории, белки, жиры, углеводы
    
    Контекст клиента:
    - Цель: ${clientContext.goal}
    - Дневная норма: ${clientContext.dailyTarget} ккал
    - Сегодня уже съел: ${clientContext.todayEaten} ккал
    - Тренировочный день: ${clientContext.isTrainingDay}
    
    Ответ в JSON формате.
  `;
  
  const response = await openai.chat.completions.create({
    model: "gpt-4-vision-preview",
    messages: [
      { role: "user", content: [
        { type: "text", text: prompt },
        { type: "image_url", image_url: { url: photoUrl } }
      ]}
    ]
  });
  
  return JSON.parse(response.choices[0].message.content);
};
```

---

## 🔗 ИНТЕГРАЦИИ

### Приоритеты

| # | Интеграция | Данные | Сложность | Фаза |
|---|------------|--------|-----------|------|
| 1 | **Whoop** | Сон, recovery, strain, HRV | Средняя | 2 |
| 2 | **Apple Health** | Шаги, активность | Средняя | 2 |
| 3 | **InBody OCR** | Состав тела (фото→данные) | Высокая | 2 |
| 4 | **Google Fit** | Шаги, активность | Средняя | 3 |
| 5 | **Oura** | Сон, готовность | Средняя | 3 |

### Архитектура интеграций

```
┌─────────────────────────────────────────────────────────────────┐
│                    INTEGRATION HUB                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐           │
│  │  Whoop  │  │  Apple  │  │  Oura   │  │ Google  │           │
│  │   API   │  │ Health  │  │   API   │  │   Fit   │           │
│  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘           │
│       │            │            │            │                 │
│       └────────────┼────────────┼────────────┘                 │
│                    │            │                               │
│                    ▼            ▼                               │
│            ┌──────────────────────────┐                        │
│            │     NORMALIZER           │                        │
│            │  Приведение к единому    │                        │
│            │  формату daily_logs      │                        │
│            └───────────┬──────────────┘                        │
│                        │                                        │
│                        ▼                                        │
│            ┌──────────────────────────┐                        │
│            │      DATABASE            │                        │
│            │  daily_logs table        │                        │
│            │  source: whoop|apple|... │                        │
│            └──────────────────────────┘                        │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  InBody OCR (отдельный flow)                            │   │
│  │  Фото → Google Vision API → Парсинг → body_composition  │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Синхронизация

- **Whoop/Oura**: ежедневно в 6:00 UTC (данные за прошлый день)
- **Apple Health**: при открытии приложения (pull)
- **InBody**: по запросу (фото → OCR)

---

## 👥 CRM-ФУНКЦИОНАЛ

### Воронка клиента

```
┌─────────────────────────────────────────────────────────────────┐
│                     CLIENT JOURNEY                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌──────────┐    ┌──────────────┐    ┌──────────┐              │
│  │   LEAD   │───►│  ONBOARDING  │───►│  ACTIVE  │              │
│  │  Заявка  │    │    Анкета    │    │  Работа  │              │
│  └──────────┘    └──────────────┘    └────┬─────┘              │
│                                           │                     │
│                          ┌────────────────┼────────────────┐    │
│                          ▼                ▼                ▼    │
│                    ┌──────────┐    ┌──────────┐    ┌────────┐  │
│                    │  PAUSED  │    │ CHURNED  │    │RETURNED│  │
│                    │  Пауза   │    │   Ушёл   │    │Вернулся│  │
│                    └──────────┘    └──────────┘    └────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Карточка клиента (для тренера)

```
┌─────────────────────────────────────────────────────────────────┐
│  👤 Марк Иванов                              [Active] 🟢        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  📊 ОСНОВНОЕ                    📈 ПРОГРЕСС                     │
│  ├── Возраст: 32               ├── Тренировок: 24/90           │
│  ├── Вес: 82 кг (ИМТ 25.1)     ├── Блок: 2 из 3                │
│  ├── Цель: Набор массы         └── Остаток: 12 тренировок      │
│  └── Ограничения: Колено                                       │
│                                                                 │
│  💰 ОПЛАТЫ                      🔗 ИНТЕГРАЦИИ                   │
│  ├── Пакет: 36 тренировок      ├── Whoop: ✅ подключён         │
│  ├── Оплачено: 15.01.2026      ├── Apple: ✅ подключён         │
│  └── Остаток: 12 тренировок    └── InBody: последний 20.01     │
│                                                                 │
│  [📝 Программа]  [🏋️ Тренировка]  [📊 Аналитика]  [💬 История] │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Финансы

```sql
-- Учёт оплат
payments (
  id,
  trainer_id,
  client_id,
  amount,           -- сумма
  currency,         -- валюта
  package_type,     -- тип пакета
  sessions_total,   -- всего тренировок
  sessions_remaining, -- остаток
  payment_date,
  notes
)

-- Примеры пакетов
INSERT INTO packages (name, sessions, price) VALUES
  ('Starter', 8, 200),
  ('Standard', 12, 280),
  ('Pro', 24, 500),
  ('Unlimited', 36, 700);
```

---

## 🔐 БЕЗОПАСНОСТЬ

### Модель доступа (RBAC)

```
┌─────────────────────────────────────────────────────────────────┐
│                    ACCESS CONTROL                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ADMIN (Николай)                                                │
│  └── Полный доступ: все тренеры, клиенты, платежи, настройки   │
│                                                                 │
│  TRAINER                                                        │
│  ├── Свои клиенты: полный доступ                               │
│  ├── Чужие клиенты: нет доступа                                │
│  ├── База упражнений: чтение общей + своя                      │
│  └── Платежи: только свои                                       │
│                                                                 │
│  CLIENT                                                         │
│  ├── Свои данные: чтение + частичная запись                    │
│  ├── Чужие данные: нет доступа                                 │
│  └── При уходе: сам решает об удалении                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Защита данных

| Категория | Данные | Защита |
|-----------|--------|--------|
| **Персональные** | Фото, телефон, email | Шифрование, ограниченный доступ |
| **Медицинские** | Ограничения, травмы | Только тренер + клиент |
| **Финансовые** | Платежи | Только тренер + админ |
| **Тренировочные** | Сессии, веса | Тренер + клиент |

### Бэкапы

- **Автоматические**: ежедневно в 3:00 UTC
- **Хранение**: 30 дней
- **Восстановление**: по запросу в течение 24ч

---

## 💰 МОНЕТИЗАЦИЯ

### Модель ценообразования

```
┌─────────────────────────────────────────────────────────────────┐
│                    PRICING MODEL                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  FREE TIER (для старта)                                         │
│  ├── 1 клиент                                                  │
│  ├── Базовый функционал                                        │
│  └── Без AI-фич                                                │
│                                                                 │
│  STARTER — $29/месяц                                            │
│  ├── До 10 клиентов                                            │
│  ├── Все базовые функции                                       │
│  ├── Интеграции (Whoop, Apple)                                 │
│  └── Без AI питания                                            │
│                                                                 │
│  PRO — $49/месяц                                                │
│  ├── До 30 клиентов                                            │
│  ├── Все функции Starter                                       │
│  ├── AI анализ питания (100 фото/месяц)                        │
│  └── Приоритетная поддержка                                    │
│                                                                 │
│  UNLIMITED — $99/месяц                                          │
│  ├── Безлимит клиентов                                         │
│  ├── Безлимит AI                                               │
│  ├── Кастомный брендинг                                        │
│  └── API доступ                                                │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Unit Economics (цель)

```
При 200 тренерах (цель на Dec 2026):
- 50% на Starter ($29): 100 × $29 = $2,900
- 35% на Pro ($49):     70 × $49 = $3,430
- 15% на Unlimited:     30 × $99 = $2,970
───────────────────────────────────────────
MRR: ~$9,300/месяц

+ Дополнительные AI-пакеты: ~$1,000/месяц
+ Комиссия с платежей (будущее): ~$500/месяц
───────────────────────────────────────────
Потенциал: $10,800/месяц

Расходы:
- Supabase Pro: $25
- Vercel Pro: $20
- OpenAI API: ~$200 (при 200 тренерах)
- Whoop API: TBD
───────────────────────────────────────────
Чистыми: ~$10,300/месяц
```

---

## 🗺️ ROADMAP

### Фаза 1: Стабилизация (Февраль 2026)

**Цель:** Стабильная работа текущих клиентов

| Задача | Приоритет | Срок |
|--------|-----------|------|
| Фикс всех багов текущей системы | 🔴 | 1 неделя |
| Стабильный онбординг (тест Алёна) | 🔴 | 1 неделя |
| Документация текущего состояния | 🟡 | 2 дня |
| Бэкап всех данных перед миграцией | 🔴 | 1 день |

**Результат:** Марк, Ярослав, Кирилл, Алёна работают без сбоев.

---

### Фаза 2: Миграция бэкенда (Март 2026)

**Цель:** Переход на Supabase

| Задача | Приоритет | Срок |
|--------|-----------|------|
| Создание схемы БД в Supabase | 🔴 | 3 дня |
| Миграция данных Coach Master | 🔴 | 2 дня |
| Миграция данных клиентов | 🔴 | 3 дня |
| Новый API (Edge Functions) | 🔴 | 1 неделя |
| Авторизация (email + пароль) | 🔴 | 3 дня |
| Тестирование на dev-среде | 🟡 | 1 неделя |
| Переключение production | 🔴 | 1 день |

**Результат:** Один URL навсегда, быстрая загрузка, авторизация.

---

### Фаза 3: Новый фронтенд (Апрель-Май 2026)

**Цель:** React PWA с дизайн-системой "Olympus"

| Задача | Приоритет | Срок |
|--------|-----------|------|
| Дизайн-система (компоненты) | 🔴 | 1 неделя |
| Трекер тренера (mobile-first) | 🔴 | 2 недели |
| Дашборд клиента (простой) | 🔴 | 1 неделя |
| Дашборд клиента (детальный) | 🟡 | 1 неделя |
| Онбординг клиента | 🔴 | 1 неделя |
| PWA (установка, офлайн) | 🟡 | 3 дня |
| Тестирование на клиентах | 🔴 | 2 недели |

**Результат:** Красивый, быстрый интерфейс. Клиенты довольны.

---

### Фаза 4: Интеграции (Июнь-Июль 2026)

**Цель:** Whoop + Apple Health + InBody OCR

| Задача | Приоритет | Срок |
|--------|-----------|------|
| Whoop API интеграция | 🔴 | 1 неделя |
| Apple HealthKit | 🟡 | 1 неделя |
| InBody OCR (Vision API) | 🟡 | 1 неделя |
| Нормализация данных | 🔴 | 3 дня |
| UI для управления интеграциями | 🔴 | 3 дня |
| Тестирование синхронизации | 🔴 | 1 неделя |

**Результат:** Автоматический сбор данных о сне, активности, составе тела.

---

### Фаза 5: AI-модули (Август-Сентябрь 2026)

**Цель:** AI питания + геймификация

| Задача | Приоритет | Срок |
|--------|-----------|------|
| AI анализ питания (фото→КБЖУ) | 🔴 | 2 недели |
| UI чата с AI для питания | 🔴 | 1 неделя |
| Система достижений | 🟡 | 1 неделя |
| Серии (streaks) | 🟡 | 3 дня |
| Необычные факты | 🟡 | 3 дня |
| Analytics AI (инсайты) | 🟢 | 2 недели |

**Результат:** Клиенты фотографируют еду → автоматический подсчёт КБЖУ.

---

### Фаза 6: Масштабирование (Октябрь-Декабрь 2026)

**Цель:** Подключение первых тренеров

| Задача | Приоритет | Срок |
|--------|-----------|------|
| Админ-панель | 🔴 | 1 неделя |
| Биллинг (Stripe) | 🔴 | 1 неделя |
| Онбординг тренера | 🔴 | 1 неделя |
| Документация для тренеров | 🟡 | 3 дня |
| Видео-инструкции | 🟢 | 1 неделя |
| Лендинг | 🟡 | 3 дня |
| Запуск бета-тестирования | 🔴 | ongoing |
| Первые платящие тренеры | 🔴 | Dec 2026 |

**Результат:** 5-10 тренеров на платформе, первый доход от подписок.

---

## 📊 МЕТРИКИ УСПЕХА

### Технические

| Метрика | Текущее | Цель |
|---------|---------|------|
| Время загрузки дашборда | 3-5 сек | < 1 сек |
| Uptime | ~95% | > 99% |
| Ошибки API | Частые | < 0.1% |

### Бизнес

| Метрика | Цель (Dec 2026) |
|---------|-----------------|
| Активных тренеров | 10-20 |
| MRR | $500-1000 |
| Churn rate | < 10% |
| NPS | > 50 |

### Продуктовые

| Метрика | Цель |
|---------|------|
| Время создания программы | < 10 мин |
| Время записи тренировки | < 30 сек/сет |
| % автозаполнения данных | > 70% |

---

## 🚀 СЛЕДУЮЩИЕ ШАГИ

### Сейчас (эта неделя)

1. ✅ Утвердить архитектуру (этот документ)
2. ⬜ Создать проект в Supabase
3. ⬜ Спроектировать схему БД детально
4. ⬜ Подготовить план миграции данных

### Ближайший месяц

1. ⬜ Миграция на Supabase
2. ⬜ Новый API с авторизацией
3. ⬜ Тестирование на текущих клиентах

---

## 📎 ПРИЛОЖЕНИЯ

### A. Схема миграции данных

```
Google Sheets                    Supabase
─────────────────────────────────────────────
Coach_Master
├── Clients           →          clients
├── Exercises         →          exercises
├── ClientBlocks      →          training_blocks
└── Settings          →          settings

Client_{Name}
├── Goals             →          clients.profile
├── Daily             →          daily_logs
├── WorkoutSessions   →          workout_sessions
├── WorkoutLog        →          workout_sets
└── TrainingBlocks    →          training_blocks
```

### B. Сравнение технологий

| Критерий | Google Sheets | Supabase |
|----------|---------------|----------|
| Скорость | Медленно | Быстро |
| Масштаб | До 100 клиентов | Безлимит |
| Авторизация | Нет | Встроена |
| Realtime | Нет | Есть |
| Бэкапы | Ручные | Автоматические |
| Стоимость | Бесплатно | $25/мес (Pro) |
| Миграция | - | Средняя сложность |

### C. Оценка бюджета

| Сервис | Free Tier | Pro | Когда переходить |
|--------|-----------|-----|------------------|
| Supabase | 500MB, 50k req | $25/мес | >10 тренеров |
| Vercel | 100GB | $20/мес | >1000 польз. |
| OpenAI | $5 free | Pay-as-you-go | Сразу |
| Stripe | 2.9% + $0.30 | - | При биллинге |

**Начальный бюджет:** $0-50/месяц
**При 10 тренерах:** ~$100/месяц
**При 100 тренерах:** ~$300/месяц

---

> **Документ создан:** 29.01.2026
> **Следующий review:** После Фазы 2 (Апрель 2026)
