# Анализ архитектуры SaaS для CS FITNESS

> Выполнено по промпту `docs/PROMPT_SAAS_ARCHITECTURE_ANALYSIS.md`.  
> Дата: февраль 2026.

---

## 1. Результаты исследования

### A. Прямые конкуренты (фитнес-тренер SaaS)

#### Trainerize (ABC Trainerize)
- **Масштаб:** 400K+ тренеров, 45K+ бизнесов; multi-tier: независимые тренеры, студии, франшизы.
- **Архитектура:** Единая облачная платформа; брендированные приложения для студий; Stripe в 45+ странах.
- **Интеграции:** Apple Health, Google Health, Garmin, Fitbit, Withings; MyFitnessPal, Fitbit; Glofox для мульти-локаций.
- **Ценность:** Автоматизация (workflows, batch assignment), групповой коучинг, неограниченные клиенты без пропорционального росту админ-нагрузки. Реферальный трекинг (заявлено +40% к конверсии).
- **Тарифы:** Free (1 клиент), Grow $9/мес (2 клиента), Pro 5 $19.80/мес (до 200 клиентов), Studio Plus $225/локация (500–1000 клиентов). 30-дневный trial.

#### TrueCoach
- **Масштаб:** 20K+ тренеров; фокус на персональных тренерах.
- **UX трекера:** Встроенный трекер в мобильном приложении (iOS/Android), 2,500+ демо-видео упражнений, таймеры отдыха/интервалов, прогресс по подходам/весу/ЧСС.
- **Touchpoints:** Web + нативные приложения; in-app messaging; PDF-листы для офлайна.
- **Фичи:** Привычки (daily/weekly/monthly), питание + MyFitnessPal, метрики тела и фото, бейджи и уведомления. Рейтинги: 4.8–4.9 в сторах.
- **Тарифы:** Starter $26.34/мес (5 клиентов), Standard $57.99 (20), Pro $136.99 (50). Годовой биллинг даёт 1–2 месяца бесплатно, 14-дневный trial.

#### PT Distinction
- **AI:** AI Program Builder (программа за ~20 сек), AI Meal Planner, AI Assistant (обратная связь, контент). AI включён во все тарифы.
- **Онбординг:** Готовые формы (PAR-Q, Lifestyle Questionnaire), настройка SMS/email/платежи/таймзона.
- **Биллинг:** Basic $19.90 (3 клиента), Pro $59.90 (25), Master $89.90 (50). Докрутка клиентов $1.60–6/мес. Без долгосрочных контрактов, отмена в первом месяце бесплатно.
- **Рейтинг:** 4.9 на Capterra, GetApp, G2.

#### My PT Hub
- Публичной информации об архитектуре и продукте мало; в поиске не найдено детального описания. **Рекомендация:** рассматривать как нишевый игрок; для бенчмарка использовать Trainerize/TrueCoach/PT Distinction.

#### Everfit
- **Видео:** Ключевой слой — видео упражнений и онбординга. Загрузка с ПК или телефона (Coach App), YouTube/Vimeo, свои превью.
- **Онбординг клиента:** Кастомное приветственное видео (по умолчанию, ссылка или загрузка).
- **Клиентское приложение:** Автоплей видео в тренировках, онбординг и привычки с видео. Видео встроено в мобильный опыт.

#### TrainHeroic
- **Геймификация:** Лидерборды в сессиях, «fist bump», празднование прогресса; маркетплейс программ от разных тренеров.
- **Community:** Уведомления, личные сообщения тренер–атлет; аналитика сессий и compliance для тренера.
- **Контент:** 1,300+ упражнений, шаблоны программ, свои упражнения с видео. Масштаб: тысячи атлетов и тренеров в нескольких странах.

---

### B. B2B2C SaaS (архитектурные паттерны)

#### Calendly / Cal.com
- **B2B2C:** Один продукт: «бизнес» (владелец календаря) и «конечный пользователь» (бронирующий). Cal.com — «Open Scheduling Infrastructure»: API, OAuth, React-компоненты (atoms) для встраивания в чужие приложения.
- **Для бизнеса:** Enterprise, встраивание, workflow-автоматизация, платежи за бронирования.
- **Для пользователя:** Выбор слота, оплата, напоминания. Embed на сайтах.
- **Вывод для CS FITNESS:** Чёткое разделение ролей (тренер vs клиент) и единый продукт с разными интерфейсами и лимитами.

#### Notion
- Прямых описаний multi-tenant/workspace в поиске не найдено. **Аналог для паттерна:** workspace = tenant (команда/тренер), страницы и БД изолированы по workspace; масштабирование за счёт блочной модели и shared databases.

#### Linear
- **Скорость UI:** Local-first sync: данные на устройстве, MobX + event-driven sync. Запись → object graph → IndexedDB → очередь в бэкенд; чтение — WebSocket → object pool → MobX.
- **Offline:** Работа офлайн, синхронизация при появлении сети; LWW (Last-Write-Win) вместо CRDT.
- **Вывод для CS FITNESS:** Трекер и критические экраны клиента — кандидаты на local-first (быстрый UI, офлайн-тренировки).

#### Stripe
- **Multi-tenant:** Connect — каждый мерчант = connected account, изолированные платежи. Монетизация: application fee или buy rate.
- **Онбординг:** Stripe-hosted (минимум кода), Embedded (бренд в приложении), API (полный контроль и ответственность за KYC). Networked onboarding — переиспользование верифицированных данных для нескольких аккаунтов.
- **Вывод для CS FITNESS:** Использовать Stripe Connect + hosted/embedded onboarding для тренеров; не изобретать сбор KYC самим.

#### Intercom / Crisp
- Real-time бизнес ↔ клиент: чат-виджет, боты, помощь в контексте продукта. Для CS FITNESS: in-app messaging тренер–клиент (как у TrueCoach/Trainerize) плюс при необходимости виджет поддержки на лендинге.

---

### C. Мессенджер-first SaaS

#### ManyChat
- **Роль:** Нет-код чат-маркетинг; 1M+ пользователей; Telegram, WhatsApp; лиды, воронки, рассылки.
- **Интеграции:** CRM, Stripe, PayPal, Zapier, Make и др.; для высоких объёмов (10K+ сообщений/день) — кастомная CRM-архитектура и роутинг.
- **Ограничение:** Один номер WhatsApp нельзя использовать одновременно в ManyChat и через Meta API.
- **Вывод для CS FITNESS:** Telegram-бот как канал быстрого ввода (вес, фото еды) и напоминаний; не обязательно единственная точка входа — дополнение к web/app.

#### Tidio
- Чат-виджет + Lyro AI (автоответы) + help desk; интеграции с e-commerce и CRM (Salesforce, Zoho и др.); API и webhooks.
- **Вывод:** Модель «виджет + бот + CRM» применима к поддержке и лидогенерации; для CS FITNESS — опционально на лендинге, не ядро продукта.

#### Kommo (amoCRM)
- **Мессенджер-центричность:** Telegram (и др.) встроен в карточку лида; двусторонняя переписка из CRM; автосоздание лидов из Telegram; Salesbot в Telegram (Advanced).
- **Настройка:** Бот в BotFather → токен в Kommo. Готовые сценарии: задачи/контакты/компании → сообщения в Telegram.
- **Вывод для CS FITNESS:** Управление диалогом с клиентом из «одного места» (кабинет тренера + Telegram); бот как дополнение, не замена веб/приложения.

---

## 2. Reference Architecture (кратко по слоям)

- **Слой 1 — Frontend:** Trainer Web (Next.js), Trainer Mobile (PWA/RN), Client Web, Client Mobile (PWA), Telegram Bot, Landing. *Обоснование:* разнесённые touchpoints как у Trainerize/TrueCoach; бот как у ManyChat/Kommo.
- **Слой 2 — API Gateway + Auth:** Rate limiting, versioning, multi-role (admin → trainer → client), webhooks (Stripe, Telegram, Whoop), file upload. *Обоснование:* единая точка входа и безопасность как у Stripe/Cal.com.
- **Слой 3 — Business Logic:** Training, Nutrition, Progress, Communication, Billing, Onboarding, Gamification. *Обоснование:* модульность как у успешных PT-платформ; AI внутри модулей (Nutrition, Training).
- **Слой 4 — Integration Hub:** Wearables, Messaging (Telegram, WhatsApp), Stripe, AI (OpenAI/Claude), OCR (InBody), аналитика. *Обоснование:* интеграции как у Trainerize; единый слой — про поддержку и масштаб.
- **Слой 5 — Data Layer:** PostgreSQL (Supabase), Redis (сессии/кэш), очередь (AI, sync, уведомления), Storage, поиск (упражнения). *Обоснование:* разделение горячих данных и фоновых задач.
- **Слой 6 — Infrastructure:** CI/CD, мониторинг, логи, бэкапы, CDN. *Обоснование:* стандарт для масштабируемого SaaS.

Детальное описание слоёв — в `docs/PROMPT_SAAS_ARCHITECTURE_ANALYSIS.md` (раздел «Часть 2»).

---

## 3. Excalidraw JSON

Три диаграммы вынесены в отдельные файлы:

| Диаграмма | Файл |
|-----------|------|
| 1. SaaS Reference Architecture — Full Stack | `docs/excalidraw-saas-reference-architecture.excalidraw.json` |
| 2. User Journey Map — Trainer & Client | `docs/excalidraw-user-journey.excalidraw.json` |
| 3. CS FITNESS — Target Architecture (Migration Path) | `docs/excalidraw-cs-fitness-migration.excalidraw.json` |

Открой любой из них в [excalidraw.com](https://excalidraw.com) (Open) или в расширении Excalidraw в VS Code/Cursor.

---

## 4. Рекомендации для CS FITNESS

### ТОП-5 архитектурных решений

1. **Stripe Connect + hosted/embedded onboarding для тренеров**  
   Обоснование: изоляция платежей по тренеру и быстрый старт без своей KYC (Stripe). Пример: Stripe Connect onboarding.  
   Действие: после перехода на Supabase заложить Connect в биллинг и использовать Stripe-hosted или Embedded onboarding.

2. **Local-first / офлайн-трекер для тренера и клиента**  
   Обоснование: скорость UI и работа без сети (зал, поездки). Пример: Linear (sync engine, IndexedDB, LWW).  
   Действие: трекер (Unified Tracker) — очередь записей локально, синхронизация при появлении сети; при росте — рассмотреть ElectricSQL или аналог.

3. **Единый Integration Hub (wearables, Telegram, Stripe, AI, OCR)**  
   Обоснование: один контур интеграций проще поддерживать и масштабировать. Пример: Trainerize (Apple Health, Garmin, Stripe, Glofox).  
   Действие: завести слой «Integration Hub» в архитектуре; новые интеграции (Whoop, Telegram, Stripe) подключать через него.

4. **AI внутри модулей (программы, питание), не «AI ради AI»**  
   Обоснование: ценность — быстрые программы и разбор питания. Пример: PT Distinction (AI Program Builder, AI Meal Planner в базовых тарифах).  
   Действие: parse-workout и будущий разбор еды по фото — часть модулей Training и Nutrition; не отдельный «AI-продукт».

5. **Чёткое разделение ролей и touchpoints (тренер vs клиент)**  
   Обоснование: один продукт, два типа пользователей и несколько каналов. Пример: Cal.com (бизнес vs конец-пользователь, embed, API).  
   Действие: единый бэкенд и Auth (admin/trainer/client); отдельные UI и лимиты по ролям; клиентский дашборд и бот — один «клиентский» опыт.

### ТОП-3 антипаттерна

1. **Один номер/аккаунт мессенджера в двух системах одновременно**  
   Пример: ManyChat + Meta API на одном WhatsApp номере — нельзя. Риск для CS FITNESS: дублирование бота и ручных рассылок на одном канале без единой очереди.  
   Избегать: один Telegram-бот от платформы, все сценарии и напоминания — через него.

2. **Ручной онбординг тренера без чек-листа и автоматизации**  
   Пример: провалы — долгая настройка без подсказок, нет trial. У PT Distinction/TrueCoach — формы, чек-листы, trial.  
   Избегать: пошаговый onboarding (аккаунт → настройки → первый клиент → первая тренировка) с прогресс-баром и напоминаниями.

3. **Монолитная «всё в одном» логика без разделения на модули**  
   Пример: сложность масштабирования и добавления AI/интеграций при «всё в одном сервисе».  
   Избегать: модули Training, Nutrition, Billing, Onboarding, Integrations как отдельные домены с чёткими API между ними.

### Приоритизация интеграций (первые 100 тренеров)

| Приоритет | Интеграция | ROI | Комментарий |
|-----------|------------|-----|-------------|
| 1 | Stripe (Connect) | Высокий | Платежи и подписки — основа монетизации. |
| 2 | Telegram Bot | Высокий | Низкий порог входа для клиентов (вес, фото еды, напоминания); сильный канал в RU/CIS. |
| 3 | Apple Health / Google Fit | Средний | Готовность к «умным» данным без обязательности для всех. |
| 4 | Whoop / Garmin | Средний | После стабильного ядра; востребовано у продвинутых тренеров. |
| 5 | InBody OCR | Ниже | Сильный маркетинг, но узкая аудитория; после стабилизации ядра. |

### Роль Telegram в продукте

- **Рекомендация:** **дополнение, не единственная точка входа.**  
- **Как у ManyChat/Kommo:** бот — канал входа для части клиентов и инструмент коммуникации/напоминаний; основная работа (программы, прогресс, детальный трекинг) — в web/PWA.  
- **Конкретно:** Telegram — быстрый ввод (вес, фото еды, «сделал тренировку»), напоминания, ссылки на дашборд/трекер; создание программ и аналитика — в кабинете тренера (web).  
- **Позже:** Telegram Mini App для трекера — опционально для аудитории, живущей в Telegram.

### Тарифная сетка (ориентир по конкурентам)

- **Free:** 1 клиент (как Trainerize Basic), ограниченный срок или урезанный функционал (без AI, без интеграций). Цель — попробовать и перейти на платный план.
- **Starter ($19–29/мес):** 5–10 клиентов, базовый трекер и дашборд, один тренер. Близко к PT Distinction Basic / Trainerize Grow.
- **Pro ($49–69/мес):** 25–50 клиентов, интеграции (Telegram, wearables), AI (разбор еды/тренировок), брендированный клиентский доступ. Близко к TrueCoach Standard / PT Distinction Pro.
- **Studio / Unlimited ($99+/мес):** много клиентов или локаций, приоритетная поддержка, опционально мультитренерность и API.

Уникальное предложение CS FITNESS: сильный AI (распознавание упражнений уже есть) + Telegram в стартовых тарифах при конкурентной цене.

---

## 5. Следующие шаги

1. **Краткосрочно (текущий этап):** Доделать стабилизацию трекера и онбординга (по SYNC_STATUS); зафиксировать Reference Architecture и диаграммы в репозитории (уже созданы).  
2. **Перед биллингом:** Выбрать модель Stripe (Connect Standard vs Express), спроектировать роли (admin/trainer/client) и лимиты по тарифам.  
3. **Параллельно продукту:** Проектирование Telegram-бота (сценарии: вес, фото еды, напоминания, ссылка на дашборд) и размещение его в Integration Hub.  
4. **После перехода на Supabase и React:** Внедрить local-first/офлайн в трекере (очередь локально, синхронизация при подключении).  
5. **Маркетинг:** Использовать диаграммы (Reference Architecture и Migration Path) в презентациях для бета-тренеров и партнёров.

---

*Документ можно обновлять по мере появления новых данных о конкурентах и сдвигов в продукте.*
